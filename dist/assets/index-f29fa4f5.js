(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}})();const l=document.querySelector(".modal-develop"),de=document.querySelector(".delivery__edit"),ie=document.querySelector(".delivery-info__edit"),ae=l.querySelector(".modal__close-icon"),ue=l.querySelector(".button-select"),H=l.querySelector(".method"),p=l.querySelector(".addresses-point-block"),f=l.querySelector(".addresses-courier-block"),J=document.querySelector(".point__title"),Q=document.querySelector(".point__address"),me=document.querySelector(".delivery-info__title"),ye=document.querySelector(".delivery-info__address");function B(){X(),l.classList.add("modal-develop__show-modal"),document.body.style.overflowY="hidden";const e=l.querySelectorAll(".method__item");let t="Пункт выдачи";for(let c=0;c<e.length;c++){const r=e[c].querySelector(".method__text"),n=e[c].querySelector(".method__input"),s=r.getAttribute("data-method");J.textContent.trim()===s&&(n.checked=!0,t=s)}let o;if(t==="Пункт выдачи"){o=p.querySelectorAll(".address__label");let c=o[0].getAttribute("for"),r=document.getElementById(c);r.checked=!0}else o=f.querySelectorAll(".address__label");for(let c=0;c<o.length;c++){const r=o[c].textContent.trim();if(Q.textContent.trim()===r){let n=o[c].getAttribute("for"),s=document.getElementById(n);s.checked=!0}}}function F(){l.classList.remove("modal-develop__show-modal"),document.body.style.overflowY="scroll"}function _e(){const t=l.querySelector(".address__input:checked + .address__info").querySelector(".address__label").textContent.trim(),o=l.querySelector(".method__input:checked + .method__text").textContent;Q.textContent=t,J.textContent=o==="Курьером"?"Курьером":"Пункт выдачи",ye.textContent=t,me.textContent=o==="Курьером"?"Доставка курьером":"Доставка в пункт выдачи"}const M=(e,t)=>{const o=e.getAttribute("data-address");if(t==="courier"){const c=f.querySelector(`.address[data-address="${o}"]`);c.parentNode.removeChild(c)}else{const c=p.querySelector(`.address[data-address="${o}"]`);c.parentNode.removeChild(c)}},X=()=>{H.querySelectorAll(".method__input")[0].checked?(p.classList.remove("addresses-block--hidden"),f.classList.add("addresses-block--hidden")):(f.classList.remove("addresses-block--hidden"),p.classList.add("addresses-block--hidden"))},pe=()=>{H.addEventListener("change",()=>{X()}),de.addEventListener("click",B),ie.addEventListener("click",B),ae.addEventListener("click",F),ue.addEventListener("click",()=>{_e(),F()}),p.addEventListener("click",e=>{e.target.getAttribute("class")==="address__delete-svg"&&M(e.target,"point")}),f.addEventListener("click",e=>{e.target.getAttribute("class")==="address__delete-svg"&&M(e.target,"courier")})},u=document.querySelector(".modal-payment"),fe=document.querySelector(".payment__edit"),be=document.querySelector(".payment-by-card__edit"),Se=u.querySelector(".modal__close-icon"),qe=u.querySelector(".button-select"),ee=document.querySelector(".payment__card-number"),C=u.querySelectorAll(".card__number");function w(){u.classList.add("modal-payment__show-modal"),document.body.style.overflowY="hidden";for(let e=0;e<C.length;e++)if(ee.textContent.trim()===C[e].textContent.trim()){let t=C[e].getAttribute("for"),o=document.getElementById(t);o.checked=!0}}function D(){u.classList.remove("modal-payment__show-modal"),document.body.style.overflowY="scroll"}function ge(){const e=document.querySelector(".payment__card > img"),t=u.querySelector(".card__radio-btn:checked + .card__number").textContent.trim(),o=u.querySelector(".card__radio-btn:checked").id,c=document.querySelector(".payment-by-card__card-icon > img"),r=document.querySelector(".payment-by-card__card-number");ee.textContent=t,e.src=`./images/icons/cards-icons/${o}.svg`,r.textContent=t,c.src=`./images/icons/cards-icons/${o}.svg`}const he=()=>{fe.addEventListener("click",w),be.addEventListener("click",w),Se.addEventListener("click",D),qe.addEventListener("click",function(){ge(),D()})},k=["товар","товара","товаров"],h=/[0-9]/,te=/^((([0-9A-Za-z]{1}[-0-9A-z\.]{0,30}[0-9A-Za-z]?)|([0-9А-Яа-я]{1}[-0-9А-я\.]{0,30}[0-9А-Яа-я]?))@([-A-Za-z]{1,}\.){1,}[-A-Za-z]{2,})$/,i=e=>Number(e.replace(/[^\d.]/ig,"")),x=(e,t)=>{let o=[2,0,1,1,1,2];return t[e%100>4&&e%100<20?2:o[e%10<5?e%10:5]]},y=e=>e.toLocaleString().toString().replace(/\,/g,"."),d=document.querySelector("form"),O=document.querySelector(".form__label--name"),Ce=document.querySelector(".form__label--name > .form__field"),V=d.querySelector(".form__label--surname"),ve=d.querySelector(".form__label--surname > .form__field"),N=document.querySelector(".form__label--email"),oe=document.querySelector(".form__label--email > .form__field"),T=d.querySelector(".form__label--tel"),Ne=d.querySelector(".form__label--tel > .form__field"),ke=(e,t)=>{const o=e.querySelector(".form__field-error"),c=e.querySelector(".form__field-name");h.test(t.value)?(o.style.opacity=1,t.style.borderColor="rgba(245, 81, 35, 1)"):(o.style.opacity=0,t.style.borderColor="rgba(0, 0, 0, 0.2)"),t.value.length>0?c.style.opacity=1:c.style.opacity=0},xe=(e,t)=>{const o=e.querySelector(".form__field-error"),c=e.querySelector(".form__field-name");let r=t.value.replace(/[a-zA-Z\.&^%$_=?><!@#*]/,""),n=/(\+7|8)[\s(]?(\d{3})[\s)]?(\d{3})[\s-]?(\d{2})[\s-]?(\d{2})/g,s=r.replace(n,"+7 ($2) $3-$4-$5");!n.test(r)&&r.length===0?(o.style.opacity=0,t.style.borderColor="rgba(0, 0, 0, 0.2)"):(o.style.opacity=1,t.style.borderColor="rgba(245, 81, 35, 1)"),r.length>0?c.style.opacity=1:c.style.opacity=0,t.value=s},Le=(e,t)=>{const o=e.querySelector(".form__field-error"),c=e.querySelector(".form__field-name");h.test(t.value)?(o.style.opacity=1,t.style.borderColor="rgba(245, 81, 35, 1)"):(o.style.opacity=0,t.style.borderColor="rgba(0, 0, 0, 0.2)"),t.value.length>0?c.style.opacity=1:c.style.opacity=0},ce=(e,t)=>{const o=e.querySelector(".form__field-error"),c=e.querySelector(".form__field-name");te.test(t.value)?(o.style.opacity=0,t.style.borderColor="rgba(0, 0, 0, 0.2)"):(o.style.opacity=1,t.style.borderColor="rgba(245, 81, 35, 1)",o.textContent="Проверьте адрес электронной почты"),t.value.length===0?c.style.opacity=0:c.style.opacity=1},Ae=e=>{e.preventDefault();const t=d.querySelector(".form__label--name > .form__field").value,o=d.querySelector(".form__label--surname > .form__field").value,c=d.querySelector(".form__label--email > .form__field").value;d.querySelector(".form__label--tel > .form__field").value,ce(N,oe);let r=!h.test(t),n=!h.test(o),s=te.test(c);alert(r&&n&&s?"Заказ успешно создан!":"Форма заполнена неверно!")},Pe=()=>{O.addEventListener("input",()=>Le(O,Ce)),V.addEventListener("input",()=>ke(V,ve)),N.addEventListener("input",()=>ce(N,oe)),T.addEventListener("input",()=>xe(T,Ne)),d.addEventListener("submit",Ae)},S=document.querySelector(".products__icon"),z=document.querySelector(".products__list"),v=document.querySelector(".products__hide-info"),Z=document.querySelector(".products__checkbox"),Y=document.querySelector(".products__select-all"),Ee=document.querySelector(".total__product-count"),$e=document.querySelector(".total__price"),q=document.querySelector(".stock__icon"),R=document.querySelector(".stock__list"),W=()=>{const e=i(Ee.textContent);S.classList.contains("closed-list-icon")?(S.classList.remove("closed-list-icon"),z.style.display="none",v.style.display="block",v.textContent=`${e} ${x(e,k)} · ${$e.textContent}`,Z.style.display="none",Y.style.display="none"):(S.classList.add("closed-list-icon"),z.style.display="block",v.style.display="none",Z.style.display="block",Y.style.display="block")},K=()=>{q.classList.contains("closed-list-icon")?(q.classList.remove("closed-list-icon"),R.style.display="none"):(q.classList.add("closed-list-icon"),R.style.display="block")},Ie=()=>{W(),K(),S.addEventListener("click",W),q.addEventListener("click",K)},re=()=>{const e=document.querySelector(".nav__item--basket"),t=document.querySelector(".tabbar__tab--active"),o=document.querySelectorAll(".product").length;e.dataset.count=`${o}`,t.dataset.numb=`${o}`,o===0&&(e.classList.remove("&::after"),t.classList.remove("&::before"))},L=document.getElementsByClassName("products")[0],b=L.getElementsByClassName("product"),Be=L.querySelector(".products__list"),A=L.querySelector(".checkbox-select-all"),Fe=document.querySelector(".stock__list"),g=document.getElementsByClassName("stock__item"),P=document.querySelector(".payment-write-off"),U=P.querySelector(".payment-write-off__description"),Me=P.querySelector(".checkbox__input"),j=document.querySelector(".order-button"),_=()=>{const e=document.querySelector(".total__price"),t=document.querySelector(".total__init-ptice"),o=document.querySelector(".total__item-discount"),c=document.querySelector(".total__product-count");let r=0,n=0,s=0,a=0;b.length===0&&(e.textContent="0 сом",t.textContent="0 сом",o.textContent="0 сом");for(let m of b){const se=m.querySelector(".checkbox__input"),$=m.querySelector(".price__total").textContent,I=m.querySelector(".price__initial-sum").textContent,le=m.querySelector(".count__sum").textContent;se.checked&&(r+=i($),n+=i(I),s+=i(I)-i($),a+=i(le))}e.textContent=`${y(r)} сом`,t.textContent=`${y(n)} сом`,o.textContent=`- ${y(s)} сом`,c.textContent=`${a} ${x(a,k)}`},ne=e=>{const o=document.querySelector(".products").querySelector(`.product[data-product="${e}"]`),c=o.querySelector(".count__sum").textContent,r=o.querySelector(".price__initial-sum"),n=r.getAttribute("data-price"),s=o.querySelector(".price__total"),a=s.getAttribute("data-price");r.textContent=y((Number(c)*Number(n)).toFixed(2)),s.textContent=y((Number(c)*Number(a)).toFixed(2)),_()},we=()=>{for(let e of b){const t=e.querySelector(".checkbox__input");A.checked?t.checked=!0:t.checked=!1}_()},De=()=>{console.log("22222");for(let e of b)e.checked||(A.checked=!1)},Oe=e=>{const t=e.getAttribute("data-product");for(let o of b)o.getAttribute("data-product")===t&&(o.remove(),re())},G=e=>{e.style.stroke==="rgb(203, 17, 171)"?e.style.stroke:e.style.stroke="rgb(203, 17, 171)"},Ve=e=>{const t=e.getAttribute("data-increment"),c=document.querySelector(".products").querySelector(`.product[data-product="${t}"]`),r=c.querySelector(".count__sum");if(c.querySelector(".count__remainder")){const n=c.querySelector(".count__remainder"),s=i(n.textContent);Number(r.textContent)<s&&(r.textContent=Number(r.textContent)+1),e.disabled=Number(r.textContent)===s}else r.textContent=Number(r.textContent)+1;ne(t),E()},Te=e=>{const t=e.getAttribute("data-decrement"),c=document.querySelector(".products").querySelector(`.product[data-product="${t}"]`),r=c.querySelector(".count__sum");let n=Number(r.textContent);if(n>1?(r.textContent=n-1,n=n-1):(c.parentNode.removeChild(c),re()),c.querySelector(".count__remainder")){const s=c.querySelector(".count__remainder"),a=i(s.textContent),m=c.querySelector(".count__increment");m.disabled=!(a>=Number(r.textContent))}ne(t),E()},ze=e=>{const t=e.getAttribute("data-missing-product");for(let o of g)o.getAttribute("data-missing-product")===t&&o.remove()},Ze=()=>{const e=document.querySelector(".out-of-stock"),t=document.querySelector(".stock__title");t.textContent=`Отсутствуют · ${g.length} ${x(g.length,k)}`,g.length===0&&(e.style.display="none")},E=()=>{if(!P.querySelector(".checkbox__input").checked)j.textContent="Заказать",U.style.display="block";else{let t=document.getElementsByClassName("total__price")[0].textContent;j.textContent=`Оплатить ${t}`,U.style.display="none"}},Ye=()=>{_(),A.addEventListener("click",we),Be.addEventListener("click",e=>{const t=e.target;t.classList.contains("action__delete-product")&&(Oe(e.target),_()),(t.classList.contains("checkbox__span")||t.classList.contains("checkbox__input"))&&(De(),_()),t.classList.contains("action__add-favorite")&&G(t),t.classList.contains("count__increment")&&Ve(t),t.classList.contains("count__decrement")&&Te(t)}),Fe.addEventListener("click",e=>{const t=e.target;t.classList.contains("action__delete-product")&&(ze(e.target),Ze()),t.classList.contains("action__add-favorite")&&G(t)}),Me.addEventListener("click",E)};document.addEventListener("DOMContentLoaded",function(){pe(),he(),Pe(),Ie(),Ye()});
