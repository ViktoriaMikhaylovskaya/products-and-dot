(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}})();const d=document.querySelector(".modal-delivery"),ae=document.querySelector(".delivery__edit"),ue=document.querySelector(".delivery-info__edit"),me=d.querySelector(".modal__close-icon"),ye=d.querySelector(".button-select"),Q=d.querySelector(".method"),p=d.querySelector(".addresses-point-block"),b=d.querySelector(".addresses-courier-block"),X=document.querySelector(".point__title"),ee=document.querySelector(".point__address"),_e=document.querySelector(".delivery-info__title"),fe=document.querySelector(".delivery-info__address"),B=()=>{te(),d.classList.add("modal-delivery__show-modal"),document.body.style.overflowY="hidden";const t=d.querySelectorAll(".method__item");let e="Пункт выдачи";for(let c=0;c<t.length;c++){const r=t[c].querySelector(".method__text"),n=t[c].querySelector(".method__input"),s=r.getAttribute("data-method");X.textContent.trim()===s&&(n.checked=!0,e=s)}let o;if(e==="Пункт выдачи"){o=p.querySelectorAll(".address__label");let c=o[0].getAttribute("for"),r=document.getElementById(c);r.checked=!0}else o=b.querySelectorAll(".address__label");for(let c=0;c<o.length;c++){const r=o[c].textContent.trim();if(ee.textContent.trim()===r){let n=o[c].getAttribute("for"),s=document.getElementById(n);s.checked=!0}}},F=()=>{d.classList.remove("modal-delivery__show-modal"),document.body.style.overflowY="scroll"},pe=()=>{const e=d.querySelector(".address__input:checked + .address__info").querySelector(".address__label").textContent.trim(),o=d.querySelector(".method__input:checked + .method__text").textContent;ee.textContent=e,X.textContent=o==="Курьером"?"Курьером":"Пункт выдачи",fe.textContent=e,_e.textContent=o==="Курьером"?"Доставка курьером":"Доставка в пункт выдачи"},M=(t,e)=>{const o=t.getAttribute("data-address");if(e==="courier"){const c=b.querySelector(`.address[data-address="${o}"]`);c.parentNode.removeChild(c)}else{const c=p.querySelector(`.address[data-address="${o}"]`);c.parentNode.removeChild(c)}},te=()=>{Q.querySelectorAll(".method__input")[0].checked?(p.classList.remove("addresses-block--hidden"),b.classList.add("addresses-block--hidden")):(b.classList.remove("addresses-block--hidden"),p.classList.add("addresses-block--hidden"))},be=()=>{Q.addEventListener("change",te),ae.addEventListener("click",B),ue.addEventListener("click",B),me.addEventListener("click",F),ye.addEventListener("click",()=>{pe(),F()}),p.addEventListener("click",t=>{t.target.getAttribute("class")==="address__delete-svg"&&M(t.target,"point")}),b.addEventListener("click",t=>{t.target.getAttribute("class")==="address__delete-svg"&&M(t.target,"courier")})},m=document.querySelector(".modal-payment"),Se=document.querySelector(".payment__edit"),qe=document.querySelector(".payment-by-card__edit"),ge=m.querySelector(".modal__close-icon"),he=m.querySelector(".button-select"),oe=document.querySelector(".payment__card-number"),k=m.querySelectorAll(".card__number"),w=()=>{m.classList.add("modal-payment__show-modal"),document.body.style.overflowY="hidden";for(let t=0;t<k.length;t++)if(oe.textContent.trim()===k[t].textContent.trim()){let e=k[t].getAttribute("for"),o=document.getElementById(e);o.checked=!0}},O=()=>{m.classList.remove("modal-payment__show-modal"),document.body.style.overflowY="scroll"},Ce=()=>{const t=document.querySelector(".payment__card > img"),e=m.querySelector(".card__radio-btn:checked + .card__number").textContent.trim(),o=m.querySelector(".card__radio-btn:checked").id,c=document.querySelector(".payment-by-card__card-icon > img"),r=document.querySelector(".payment-by-card__card-number");oe.textContent=e,t.src=`./images/icons/cards-icons/${o}.svg`,r.textContent=e,c.src=`./images/icons/cards-icons/${o}.svg`},Ne=()=>{Se.addEventListener("click",w),qe.addEventListener("click",w),ge.addEventListener("click",O),he.addEventListener("click",function(){Ce(),O()})},L=["товар","товара","товаров"],C=/[0-9]/,ce=/^((([0-9A-Za-z]{1}[-0-9A-z\.]{0,30}[0-9A-Za-z]?)|([0-9А-Яа-я]{1}[-0-9А-я\.]{0,30}[0-9А-Яа-я]?))@([-A-Za-z]{1,}\.){1,}[-A-Za-z]{2,})$/,re=/[^\d]/,ne=/(\+7|8)[\s(]?(\d{3})[\s)]?(\d{3})[\s-]?(\d{2})[\s-]?(\d{2})/g,u=t=>Number(t.replace(/[^\d.]/ig,"")),A=(t,e)=>{let o=[2,0,1,1,1,2];return e[t%100>4&&t%100<20?2:o[t%10<5?t%10:5]]},_=t=>t.toLocaleString().toString().replace(/\,/g,"."),l=document.querySelector("form"),T=document.querySelector(".form__label--name"),ve=document.querySelector(".form__label--name > .form__field"),V=l.querySelector(".form__label--surname"),ke=l.querySelector(".form__label--surname > .form__field"),D=document.querySelector(".form__label--email"),xe=document.querySelector(".form__label--email > .form__field"),z=l.querySelector(".form__label--tel"),Le=l.querySelector(".form__label--tel > .form__field"),Z=l.querySelector(".form__label--inn"),Ae=l.querySelector(".form__label--inn > .form__field"),Ie=(t,e)=>{const o=t.querySelector(".form__field-error"),c=t.querySelector(".form__field-name");C.test(e.value)?(o.style.opacity=1,e.style.borderColor="rgba(245, 81, 35, 1)"):(o.style.opacity=0,e.style.borderColor="rgba(0, 0, 0, 0.2)"),e.value.length>0?c.style.opacity=1:c.style.opacity=0},Ee=(t,e)=>{const o=t.querySelector(".form__field-error"),c=t.querySelector(".form__field-name");let r=e.value.replace(/[a-zA-Z\.&^%$_=?><!@#*]/,"");ne.test(r)||r.length===0?(o.style.opacity=0,e.style.borderColor="rgba(0, 0, 0, 0.2)"):(o.style.opacity=1,e.style.borderColor="rgba(245, 81, 35, 1)"),r.length>0?c.style.opacity=1:c.style.opacity=0},Pe=(t,e)=>{const o=t.querySelector(".form__field-error"),c=t.querySelector(".form__field-name");C.test(e.value)?(o.style.opacity=1,e.style.borderColor="rgba(245, 81, 35, 1)"):(o.style.opacity=0,e.style.borderColor="rgba(0, 0, 0, 0.2)"),e.value.length>0?c.style.opacity=1:c.style.opacity=0},$e=(t,e)=>{const o=t.querySelector(".form__field-error"),c=t.querySelector(".form__field-name");ce.test(e.value)?(o.style.opacity=0,e.style.borderColor="rgba(0, 0, 0, 0.2)"):(o.style.opacity=1,e.style.borderColor="rgba(245, 81, 35, 1)",o.textContent="Проверьте адрес электронной почты"),e.value.length===0?c.style.opacity=0:c.style.opacity=1},Be=(t,e)=>{const o=t.querySelector(".form__field-extra-text"),c=t.querySelector(".form__field-name");re.test(e.value)?(e.style.borderColor="rgba(245, 81, 35, 1)",o.style.opacity=1,o.textContent="Проверьте ИНН",o.style.color="rgba(245, 81, 35, 1)"):(o.style.borderColor="rgba(0, 0, 0, 0.2)",o.style.color="rgba(0, 0, 0, 1)",o.textContent="Для таможенного оформления",e.style.borderColor="rgba(0, 0, 0, 0.2)"),e.value.length===0?c.style.opacity=0:c.style.opacity=1},Fe=t=>{const e=l.querySelector(".form__label--name > .form__field").value,o=l.querySelector(".form__label--surname > .form__field").value,c=l.querySelector(".form__label--email > .form__field").value,r=l.querySelector(".form__label--tel > .form__field").value,n=l.querySelector(".form__label--inn > .form__field").value;let s=!C.test(e),i=!C.test(o),a=ce.test(c),v=!ne.test(r),S=!re.test(n);alert(s&&i&&a&&S&&v?"Заказ успешно создан!":"Форма заполнена неверно!")},Me=()=>{T.addEventListener("input",()=>Pe(T,ve)),V.addEventListener("input",()=>Ie(V,ke)),D.addEventListener("input",()=>$e(D,xe)),z.addEventListener("input",()=>Ee(z,Le)),Z.addEventListener("input",()=>Be(Z,Ae)),l.addEventListener("submit",Fe)},q=document.querySelector(".products__icon"),Y=document.querySelector(".products__list"),x=document.querySelector(".products__hide-info"),R=document.querySelector(".products__checkbox"),W=document.querySelector(".products__select-all"),we=document.querySelector(".total__product-count"),Oe=document.querySelector(".total__price"),g=document.querySelector(".stock__icon"),K=document.querySelector(".stock__list"),U=()=>{const t=u(we.textContent);q.classList.contains("closed-list-icon")?(q.classList.remove("closed-list-icon"),Y.style.display="none",x.style.display="block",x.textContent=`${t} ${A(t,L)} · ${Oe.textContent}`,R.style.display="none",W.style.display="none"):(q.classList.add("closed-list-icon"),Y.style.display="block",x.style.display="none",R.style.display="block",W.style.display="block")},j=()=>{g.classList.contains("closed-list-icon")?(g.classList.remove("closed-list-icon"),K.style.display="none"):(g.classList.add("closed-list-icon"),K.style.display="block")},Te=()=>{U(),j(),q.addEventListener("click",U),g.addEventListener("click",j)},se=()=>{const t=document.querySelector(".nav__item--basket"),e=document.querySelector(".tabbar__tab--active"),o=document.querySelectorAll(".product").length;t.dataset.count=`${o}`,e.dataset.numb=`${o}`,o===0&&(t.classList.remove("&::after"),e.classList.remove("&::before"))},I=document.getElementsByClassName("products")[0],y=I.getElementsByClassName("product"),Ve=I.querySelector(".products__list"),N=I.querySelector(".checkbox-select-all"),De=document.querySelector(".stock__list"),h=document.getElementsByClassName("stock__item"),E=document.querySelector(".payment-write-off"),G=E.querySelector(".payment-write-off__description"),ze=E.querySelector(".checkbox__input"),H=document.querySelector(".order-button"),f=()=>{const t=document.querySelector(".total__price"),e=document.querySelector(".total__init-ptice"),o=document.querySelector(".total__item-discount"),c=document.querySelector(".total__product-count");let r=0,n=0,s=0,i=0;y.length===0&&(t.textContent="0 сом",e.textContent="0 сом",o.textContent="0 сом");for(let a of y){const v=a.querySelector(".checkbox__input"),S=a.querySelector(".price__total").textContent,$=a.querySelector(".price__initial-sum").textContent,ie=a.querySelector(".count__sum").textContent;v.checked&&(r+=u(S),n+=u($),s+=u($)-u(S),i+=u(ie))}t.textContent=`${_(r)} сом`,e.textContent=`${_(n)} сом`,o.textContent=`- ${_(s)} сом`,c.textContent=`${i} ${A(i,L)}`},le=t=>{const o=document.querySelector(".products").querySelector(`.product[data-product="${t}"]`),c=o.querySelector(".count__sum").textContent,r=o.querySelector(".price__initial-sum"),n=r.getAttribute("data-price"),s=o.querySelector(".price__total"),i=s.getAttribute("data-price");r.textContent=_((Number(c)*Number(n)).toFixed(2)),s.textContent=_((Number(c)*Number(i)).toFixed(2)),f()},Ze=()=>{for(let t of y){const e=t.querySelector(".checkbox__input");N.checked?e.checked=!0:e.checked=!1}f()},de=()=>{let t=0;for(let e of y)e.querySelector(".checkbox__input").checked?t++:N.checked=!1;t===y.length&&(N.checked=!0)},Ye=t=>{const e=t.getAttribute("data-product");for(let o of y)o.getAttribute("data-product")===e&&(o.remove(),se());de()},J=t=>{t.style.stroke==="rgb(203, 17, 171)"?t.style.stroke="none":t.style.stroke="rgb(203, 17, 171)"},Re=t=>{const e=t.getAttribute("data-increment"),c=document.querySelector(".products").querySelector(`.product[data-product="${e}"]`),r=c.querySelector(".count__sum");if(c.querySelector(".count__remainder")){const n=c.querySelector(".count__remainder"),s=u(n.textContent);Number(r.textContent)<s&&(r.textContent=Number(r.textContent)+1),t.disabled=Number(r.textContent)===s}else r.textContent=Number(r.textContent)+1;le(e),P()},We=t=>{const e=t.getAttribute("data-decrement"),c=document.querySelector(".products").querySelector(`.product[data-product="${e}"]`),r=c.querySelector(".count__sum");let n=Number(r.textContent);if(n>1?(r.textContent=n-1,n=n-1):(c.parentNode.removeChild(c),se()),c.querySelector(".count__remainder")){const s=c.querySelector(".count__remainder"),i=u(s.textContent),a=c.querySelector(".count__increment");a.disabled=!(i>=Number(r.textContent))}le(e),P()},Ke=t=>{const e=t.getAttribute("data-missing-product");for(let o of h)o.getAttribute("data-missing-product")===e&&o.remove()},Ue=()=>{const t=document.querySelector(".out-of-stock"),e=document.querySelector(".stock__title");e.textContent=`Отсутствуют · ${h.length} ${A(h.length,L)}`,h.length===0&&(t.style.display="none")},P=()=>{if(!E.querySelector(".checkbox__input").checked)H.textContent="Заказать",G.style.display="block";else{let e=document.getElementsByClassName("total__price")[0].textContent;H.textContent=`Оплатить ${e}`,G.style.display="none"}},je=()=>{f(),N.addEventListener("click",Ze),Ve.addEventListener("click",t=>{const e=t.target;e.classList.contains("action__delete-product")&&(Ye(t.target),f()),(e.classList.contains("checkbox__span")||e.classList.contains("checkbox__input"))&&(de(),f()),e.classList.contains("action__add-favorite")&&J(e),e.classList.contains("count__increment")&&Re(e),e.classList.contains("count__decrement")&&We(e)}),De.addEventListener("click",t=>{const e=t.target;e.classList.contains("action__delete-product")&&(Ke(t.target),Ue()),e.classList.contains("action__add-favorite")&&J(e)}),ze.addEventListener("click",P)};document.addEventListener("DOMContentLoaded",function(){be(),Ne(),Me(),Te(),je()});
